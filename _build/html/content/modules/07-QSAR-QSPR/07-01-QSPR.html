
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Molecular Descriptors &#8212; Data Chemistry 2025</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/oldcustom.css?v=e52fa269" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=ba2d5b83" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/modules/07-QSAR-QSPR/07-01-QSPR';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Module 8: Molecular Similarity" href="../08-Molecular-Similarity/README.html" />
    <link rel="prev" title="Module 7: Quantitative Structure Property Reationships" href="README.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt="Data Chemistry 2025 - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt="Data Chemistry 2025 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../index.html">
                    2025 Data Chemistry OLCC
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01-OLCC-Primer/README.html">Module 1: OLCC Primer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../01-OLCC-Primer/01-1-OLCC-Primer.html">Module 1.1: OLCC Primer</a></li>






<li class="toctree-l2"><a class="reference internal" href="../01-OLCC-Primer/01-2-python-basics.html">1.2 Python Basics</a></li>


<li class="toctree-l2"><a class="reference internal" href="../01-OLCC-Primer/01-3-python-intermediate.html">1.3 Python Intermediate</a></li>





</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02-Introduction/README.html">Module 2: Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../02-Introduction/02-1-PubChemDataTypes.html">2.1 PubChem Data Types</a></li>



<li class="toctree-l2"><a class="reference internal" href="../02-Introduction/02-2-PUG-REST-activity.html">2.2 PUG-REST Activity</a></li>






</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03-Public-Chemical-Databases/README.html">Module 3: Public Chemical Databases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03-Public-Chemical-Databases/03-01-Survey-Public-Chemical-Databases.html">Module 1.1: Public Compound Databases</a></li>



</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04-Chemical-Representations/README.html">Module 4: Chemical Representations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../04-Chemical-Representations/04-01-introduction_chemical_representations.html">4.1 Chemical Representation</a></li>


<li class="toctree-l2"><a class="reference internal" href="../04-Chemical-Representations/04-02-PubChem3D_update.html">4.2 PubChem 3D</a></li>


<li class="toctree-l2"><a class="reference internal" href="../04-Chemical-Representations/04-03-Substructure_Searching_with_SMARTS.html">4.3 SMARTS Substructure Searching</a></li>


</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05-Searching-Chemical-Databases/README.html">Module 5: Searching Chemical Databases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../05-Searching-Chemical-Databases/05-01-Exploring-PubChem.html">5.1 Exploring PubChem</a></li>



<li class="toctree-l2"><a class="reference internal" href="../05-Searching-Chemical-Databases/05-02-structure-inputs.html">5.1 Searching with Structures</a></li>



<li class="toctree-l2"><a class="reference internal" href="../05-Searching-Chemical-Databases/05-03-list-conversion.html">5.1 List Conversions</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06-BioAssay/README.html">Module 6: BioAssays</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../06-BioAssay/06-1-Bioactivity_Primer.html">PubChem Bioactivity Primer</a></li>

<li class="toctree-l2"><a class="reference internal" href="../06-BioAssay/06-2-eda-protein1.html">Exploratory Data Analysis 1: <br/><br/> Concordance of Thyroid Hormone Receptor Activity in Rats and Humans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06-BioAssay/06-3-eda-pathway.html">Exploratory Data Analysis 2:<br/><br/>Chemical Modulation of Renin-Angiotensin-Aldosterone system (RAAS)</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">Module 7: Quantitative Structure Property Reationships</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Molecular Descriptors</a></li>








</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../08-Molecular-Similarity/README.html">Module 8: Molecular Similarity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../08-Molecular-Similarity/08-1-MolSimularity.html">Fingerprint Generation</a></li>



<li class="toctree-l2"><a class="reference internal" href="../08-Molecular-Similarity/08-2-MolSimularity.html">What is a bit vector?</a></li>


<li class="toctree-l2"><a class="reference internal" href="../08-Molecular-Similarity/08-3-MolSimularity.html">Objectives</a></li>





</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../09-CADDD/README.html">Module 9: Computer-Aided Drug Discovery and Design</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../09-CADDD/09-1-virtual-screening.html">Virtual Screening</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../10-Machine-Learning/README.html">Module 10: Supervised ML</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../10-Machine-Learning/10-01-supervised-ML.html">Machine Learning Basics</a></li>





</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../appendices/README.html">Appendices</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../appendices/Pandas.html">Introduction to Pandas</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/DivCHED-CCCE/DataChemistry2025OLCC/master?urlpath=lab/tree/docs/content/modules/07-QSAR-QSPR/07-01-QSPR.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://nanohub.org/tools/datachemolcc/hub/user-redirect/git-pull?repo=https%3A//github.com/DivCHED-CCCE/DataChemistry2025OLCC&urlpath=lab/tree/DataChemistry2025OLCC/docs/content/modules/07-QSAR-QSPR/07-01-QSPR.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/DivCHED-CCCE/DataChemistry2025OLCC/blob/master/docs/content/modules/07-QSAR-QSPR/07-01-QSPR.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/DivCHED-CCCE/DataChemistry2025OLCC" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/DivCHED-CCCE/DataChemistry2025OLCC/issues/new?title=Issue%20on%20page%20%2Fcontent/modules/07-QSAR-QSPR/07-01-QSPR.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/content/modules/07-QSAR-QSPR/07-01-QSPR.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Molecular Descriptors</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Molecular Descriptors</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#using-rdkit-and-mordred-to-calculate-descriptors">Using rdkit and Mordred to calculate descriptors</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wiener-index">Wiener Index</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zagreb-indices">Zagreb Indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#looping-through-a-list-of-molecules">Looping through a list of molecules</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#using-descriptors-to-predict-molecular-properties">Using descriptors to predict molecular properties</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boiling-point-data">Boiling Point data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphing-the-data">Graphing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-descriptors-to-the-dataset">Adding descriptors to the dataset</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mulitple-regression-analysis-using-statsmodels">Mulitple regression analysis using statsmodels</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-summary-and-analysis-using-partial-regression-plots">Model summary and analysis using partial regression plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-good-is-our-model">How good is our model?</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-1">Assignment 1</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-2">Assignment 2</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-credit-challenge-assignment">Extra Credit Challenge Assignment</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Extra Credit Challenge Assignment</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgment">Acknowledgment</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <center><H2>Quantitative Structure-Property Relationships</H2></center>
<p>Quantitative Structure-Property Relationships (QSPR) and Quantitative
Structure-Activity Relationships (QSAR) use statistical models to relate a set
of predictor values to a response variable. Molecules are described using a set
of <em>descriptors</em>, and then mathematical relationships can be developed to explain
observed properties. In QSPR and QSAR, physico-chemical properties of theoretical
descriptors of chemicals are used to predict either a physical property or a
biological outcome.</p>
<div class="alert alert-block alert-info">
<p>Objectives:</p>
<ul class="simple">
<li><p>Explore the Mordred library to algorithmically calculate descriptors for molecules</p></li>
<li><p>Use molecular descriptors to calculate QSPR</p></li>
<li><p>Use multiple linear regression to create best predictive equation for boiling points of alkanes</p></li>
</ul>
<section id="molecular-descriptors">
<h1>Molecular Descriptors<a class="headerlink" href="#molecular-descriptors" title="Link to this heading">#</a></h1>
<p>A molecular descriptor is “final result of a logical and mathematical procedure,
which transforms chemical information encoded within a symbolic representation
of a molecule into a useful number or the result of some standardized
experiment” (Todeschini, R.; Consonni, V. <em>Molecular descriptors for
chemoinformatics</em> <strong>2009</strong> Wiley‑VCH, Weinheim). You are already familiar with
descriptors such as molecular weight or number of heavy atoms and we have
queried PubChem for data such as XLogP. We’ll examine just a few simple
descriptors, but thousands have been developed for applications in QSPR.</p>
</section>
<section id="using-rdkit-and-mordred-to-calculate-descriptors">
<h1>Using rdkit and Mordred to calculate descriptors<a class="headerlink" href="#using-rdkit-and-mordred-to-calculate-descriptors" title="Link to this heading">#</a></h1>
<p>In the lecture portion of this activity you have been using algorithms to calulate some molecular descriptors based on graph theory (e.g. Wiener Index). This is time consuming for an individual, but programs can be used to complete this much
easier. We will use the rdkit and Mordred python libraries to help us out.</p>
<p><a href="https://jcheminf.biomedcentral.com/articles/10.1186/s13321-018-0258-y">Mordred is a molecular descriptor calculator</a> that was originally released in 2018 as an python library that supports more than 1800 molecular discriptors. It was developed to overcome issues other libraries have such as software bugs and insufficient updates.</p>
<p>Originally developed by Hirotomo Moriwaki, it is now maintained by the Mordred Communicty https://github.com/JacksonBurns/mordred-community. It can be installed using conda-forge.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">mordredcommunity</span>
</pre></div>
</div>
<p>Mordred’s documentation can be found here: https://mordred-descriptor.github.io/documentation/master/#</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mordred</span><span class="w"> </span><span class="kn">import</span> <span class="n">Calculator</span><span class="p">,</span> <span class="n">descriptors</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate total descriptors in Mordred library</span>
<span class="n">n_all</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Calculator</span><span class="p">(</span><span class="n">descriptors</span><span class="p">,</span> <span class="n">ignore_3D</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">descriptors</span><span class="p">)</span>
<span class="n">n_2D</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Calculator</span><span class="p">(</span><span class="n">descriptors</span><span class="p">,</span> <span class="n">ignore_3D</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">descriptors</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Descriptors in the Mordred library&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2D:    </span><span class="si">{:5}</span><span class="se">\n</span><span class="s2">3D:    </span><span class="si">{:5}</span><span class="se">\n</span><span class="s2">------------</span><span class="se">\n</span><span class="s2">total: </span><span class="si">{:5}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_2D</span><span class="p">,</span> <span class="n">n_all</span> <span class="o">-</span> <span class="n">n_2D</span><span class="p">,</span> <span class="n">n_all</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<section id="wiener-index">
<h2>Wiener Index<a class="headerlink" href="#wiener-index" title="Link to this heading">#</a></h2>
<p>We already calculated the Wiener index for <em>n</em>-pentane and 2-methylpentane with the accompanying lecture materials. Now
let’s have Mordred do it for us.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>                                 <span class="c1"># imports the Chem module from rdkit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mordred</span><span class="w"> </span><span class="kn">import</span> <span class="n">WienerIndex</span>                        <span class="c1"># imports the Wiener index from mordred</span>
<span class="n">pentane</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CCCCC&#39;</span><span class="p">)</span>                  <span class="c1"># Use rdkit to create a mol file from the smiles string for n-pentane</span>
<span class="n">methyl_pentane</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CCCC(C)C&#39;</span><span class="p">)</span>        <span class="c1">#  and for 2-methylpentane</span>
<span class="n">wiener_index</span> <span class="o">=</span> <span class="n">WienerIndex</span><span class="o">.</span><span class="n">WienerIndex</span><span class="p">()</span>               <span class="c1"># create descriptor instance for Wiener index</span>
<span class="n">result1</span> <span class="o">=</span> <span class="n">wiener_index</span><span class="p">(</span><span class="n">pentane</span><span class="p">)</span>                        <span class="c1"># calculate wiener index for n-pentane</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">wiener_index</span><span class="p">(</span><span class="n">methyl_pentane</span><span class="p">)</span>                 <span class="c1">#  and for 2-methylpentane</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Wiener index for n-pentane is: &quot;</span><span class="p">,</span> <span class="n">result1</span><span class="p">)</span>  <span class="c1"># display result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Wiener index for 2-methylpentane is: &quot;</span><span class="p">,</span> <span class="n">result2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="zagreb-indices">
<h2>Zagreb Indices<a class="headerlink" href="#zagreb-indices" title="Link to this heading">#</a></h2>
<p>And we can do the same for the different Zagreb indices for <em>n</em>-pentane and
2-methylpentane.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mordred</span><span class="w"> </span><span class="kn">import</span> <span class="n">ZagrebIndex</span>

<span class="n">zagreb_index1</span> <span class="o">=</span> <span class="n">ZagrebIndex</span><span class="o">.</span><span class="n">ZagrebIndex</span><span class="p">(</span><span class="n">version</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>            <span class="c1"># create descriptor instance for Zagreb index 1</span>
<span class="n">zagreb_index2</span> <span class="o">=</span> <span class="n">ZagrebIndex</span><span class="o">.</span><span class="n">ZagrebIndex</span><span class="p">(</span><span class="n">version</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>            <span class="c1"># create descriptor instance for Zagreb index 2</span>

<span class="n">result_Z1</span> <span class="o">=</span> <span class="n">zagreb_index1</span><span class="p">(</span><span class="n">pentane</span><span class="p">)</span>                              <span class="c1"># calculate Z1 descriptor value for n-pentane</span>
<span class="n">result_Z2</span> <span class="o">=</span> <span class="n">zagreb_index2</span><span class="p">(</span><span class="n">pentane</span><span class="p">)</span>                              <span class="c1"># calculate Z2 descriptor value for n-pentane</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Zagreb index 1 for n-pentane is:&quot;</span><span class="p">,</span> <span class="n">result_Z1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Zagreb index 2 for n-pentane is:&quot;</span><span class="p">,</span> <span class="n">result_Z2</span><span class="p">)</span>

<span class="n">result_Z1</span> <span class="o">=</span> <span class="n">zagreb_index1</span><span class="p">(</span><span class="n">methyl_pentane</span><span class="p">)</span>                       <span class="c1"># and for 2-methylpentane as well</span>
<span class="n">result_Z2</span> <span class="o">=</span> <span class="n">zagreb_index2</span><span class="p">(</span><span class="n">methyl_pentane</span><span class="p">)</span>                      
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Zagreb index 1 for 2-methylpentane is:&quot;</span><span class="p">,</span> <span class="n">result_Z1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Zagreb index 2 for 2-methylpentane is:&quot;</span><span class="p">,</span> <span class="n">result_Z2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As you can see from the code above, each index will have different code that
needs to be followed for programming. Each descriptor and the resulting code
syntax can be found here
<a class="reference external" href="http://mordred-descriptor.github.io/documentation/master/api/modules.html">http://mordred-descriptor.github.io/documentation/master/api/modules.html</a></p>
</section>
<section id="looping-through-a-list-of-molecules">
<h2>Looping through a list of molecules<a class="headerlink" href="#looping-through-a-list-of-molecules" title="Link to this heading">#</a></h2>
<p>Now that we have an understanding on how rdkit and mordred work to get our
descriptors, let’s simplify the code using a looping structure:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">smiles</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CCC&quot;</span><span class="p">,</span> <span class="s2">&quot;CCCC&quot;</span><span class="p">,</span> <span class="s2">&quot;CCCCC&quot;</span><span class="p">,</span> <span class="s2">&quot;CCCC(C)C&quot;</span><span class="p">,</span><span class="s2">&quot;CC(C)C(C)C&quot;</span><span class="p">]</span>         <span class="c1">#store smiles strings in a list</span>

<span class="k">for</span> <span class="n">smile</span> <span class="ow">in</span> <span class="n">smiles</span><span class="p">:</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">smile</span><span class="p">)</span>                      <span class="c1"># convert smiles string to mol file</span>
    <span class="n">result_Z1</span> <span class="o">=</span> <span class="n">zagreb_index1</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>                       <span class="c1"># calculate Z1 descriptor value</span>
    <span class="n">result_Z2</span> <span class="o">=</span> <span class="n">zagreb_index2</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>                       <span class="c1"># calculate Z2 descriptor value</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Zagreb index 1 for&quot;</span><span class="p">,</span> <span class="n">smile</span><span class="p">,</span> <span class="s2">&quot;is:&quot;</span><span class="p">,</span> <span class="n">result_Z1</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The Zagreb index 2 for&quot;</span><span class="p">,</span> <span class="n">smile</span><span class="p">,</span> <span class="s2">&quot;is:&quot;</span><span class="p">,</span> <span class="n">result_Z2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="using-descriptors-to-predict-molecular-properties">
<h1>Using descriptors to predict molecular properties<a class="headerlink" href="#using-descriptors-to-predict-molecular-properties" title="Link to this heading">#</a></h1>
<p>For this exercise we will take a series of alkanes and create an equation that
will allow us to predict boiling points. We will start with a 30 molecule alkane
training set and obtain various descriptors and see how they can predict
the physical property boiling point.</p>
<p>For this exercise we will be using the <a class="reference external" href="https://pandas.pydata.org/">pandas</a> (Python Data Analysis) library to
help us read, write and manage data. We will also use matplotlib to generate
graphs.</p>
<section id="boiling-point-data">
<h2>Boiling Point data<a class="headerlink" href="#boiling-point-data" title="Link to this heading">#</a></h2>
<p>Let’s start by reading and graphing a set of boiling point data. First we read
our csv file into a pandas “dataframe”. Notice that we can generate a nicely
formatted table from our dataframe by just entering the name of the dataframe on
the last line.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>        <span class="c1"># import the Python Data Analysis Library with the shortened name pd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;BP.csv&quot;</span><span class="p">)</span> <span class="c1"># read in the file into a pandas dataframe</span>
<span class="n">df</span>                         <span class="c1"># print the dataframe</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="graphing-the-data">
<h2>Graphing the data<a class="headerlink" href="#graphing-the-data" title="Link to this heading">#</a></h2>
<p>Now we can graph the data using matplotlib.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">MW</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">BP_K</span><span class="p">)</span>     <span class="c1"># plot of boiling point (in K) vs molecular weight</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Molecular Weight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Boiling Point in Kelvin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
<strong>Check your understanding</strong>
<ul class="simple">
<li><p>What is the boiling point of a molecule with molecular weight = 60 g/mol?</p></li>
<li><p>What is the boiling point of a molecule with molecular weight = 120 g/mol?</p></li>
</ul>
<p>Is molecular weight alone a good descriptor to predict boiling points for this series of alkanes?</p>
<p>Clearly from the data we can see that we have multiple molecules with the same
molecular weight, but different boiling points. Molecular weight is therefore
not the best predictor of boiling point. We can see if there are other
descriptors that we can use such as Weiner or Zagreb. Let’s add various
descriptors to the dataframe.</p>
</section>
<section id="adding-descriptors-to-the-dataset">
<h2>Adding descriptors to the dataset<a class="headerlink" href="#adding-descriptors-to-the-dataset" title="Link to this heading">#</a></h2>
<p>We can now calculate the Wiener and Zagreb indices for each of our
hydrocarbons and add them to the dataframe.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create new lists to store results we calculate</span>
<span class="n">result_Wiener</span><span class="o">=</span> <span class="p">[]</span>
<span class="n">result_Z1</span><span class="o">=</span> <span class="p">[]</span>
<span class="n">result_Z2</span><span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>                <span class="c1"># iterate through each row of the CSV data</span>
    <span class="n">SMILE</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;SMILES&#39;</span><span class="p">]</span>                       <span class="c1"># get SMILES string from row</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">SMILE</span><span class="p">)</span>             <span class="c1"># convert smiles string to mol file</span>
    <span class="n">result_Wiener</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wiener_index</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>     <span class="c1"># calculate Wiener index descripter value</span>
    <span class="n">result_Z1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zagreb_index1</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>        <span class="c1"># calculate zagreb (Z1) descriptor value</span>
    <span class="n">result_Z2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zagreb_index2</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>        <span class="c1"># calculate zagreb (Z2) descriptor value</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Wiener&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_Wiener</span>           <span class="c1"># add the results for WienerIndex to dataframe</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Z1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_Z1</span>                   <span class="c1"># add the results for Zagreb 1 to dataframe</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Z2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_Z2</span>                   <span class="c1"># add the results for Zagreb 2 to dataframe</span>
<span class="n">df</span>                                     <span class="c1"># print the updated dataframe</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can see how each of these descriptors are related to the boiling points
of their respective compounds.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Wiener</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">BP_K</span><span class="p">)</span> <span class="c1"># plot of BP versus Wiener index</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wiener Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Boiling Point in Kelvin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Z1</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">BP_K</span><span class="p">)</span> <span class="c1"># plot of BP versus Zagreb M1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zagreb M1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Boiling Point in Kelvin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Z2</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">BP_K</span><span class="p">)</span> <span class="c1"># plot of BP versus Zagreb M2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Zagreb M2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Boiling Point in Kelvin&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
<strong>Check your understanding</strong>
<ul class="simple">
<li><p>Do these other indicators provide some insight into predicting boiling point?</p></li>
<li><p>Do they perform better or worse than boiling point?</p></li>
<li><p>If no one descriptor (independent variable) represents boiling point (dependent variable), might a combination of these descriptors predict the boiling point?</p></li>
</ul>
</section>
</section>
<section id="mulitple-regression-analysis-using-statsmodels">
<h1>Mulitple regression analysis using statsmodels<a class="headerlink" href="#mulitple-regression-analysis-using-statsmodels" title="Link to this heading">#</a></h1>
<p>We have been attempting to describe the relationship between one variable (MW, 2D molecular descriptors) and boiling point by creating a regression model and observing (through intraocular analysis <em>i.e. eye-balling it</em>) if there is a relationship to estimate how much the dependent variable changes in relation to the independent variable.</p>
<p>Multiple linear regression is a statistical method that can use multiple independent variables to predict the effect on the dependent variable.</p>
<p>The <a class="reference external" href="https://www.statsmodels.org/stable/index.html">statsmodels</a> package provides numerous tools for performing statistical
analysis using Python. In this case, we want to perform a <em>multiple linear
regression</em> using all of our descriptors (molecular weight, Wiener index, Zagreb
indices) to help predict our boiling point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>           <span class="c1"># import the statsmodels library as sm</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;MW&quot;</span><span class="p">,</span> <span class="s2">&quot;Wiener&quot;</span><span class="p">,</span> <span class="s2">&quot;Z1&quot;</span><span class="p">,</span> <span class="s2">&quot;Z2&quot;</span><span class="p">]]</span>   <span class="c1"># select our independent variables</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>                 <span class="c1"># add an intercept to our model</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;BP_K&quot;</span><span class="p">]]</span>                       <span class="c1"># select BP as our dependent variable</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>              <span class="c1"># set up our model</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>         <span class="c1"># make the predictions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>                 <span class="c1"># print out statistical summary</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
<strong>Check your understanding</strong>
<p>There is quite a bit of statistical data reported from the statsmodel package. Let’s focus on a few pieces of data.</p>
<ul class="simple">
<li><p>What does the calcualte R<sup>2</sup> tell you about the equation of the multiple linear regression?</p></li>
<li><p>What do the sign and magnitude of the coefficients tell you about the correlation between independent variable and the dependent variable?</p></li>
<li><p>What does the p-value indicate about these independent variables predicting the dependent variable?</p></li>
</ul>
<p>Note above that we now have coeffiecients for an equation that can be used for prediction of boiling points for molecules not included in our dataset. The equation would be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Predicted BP = 4.4325 * MW - 0.6411 * Weiner - 4.3920 * Z1 + 0.2982 * Z2 + 55.5695
</pre></div>
</div>
<p>We can use this equation to predict the boiling point of a new molecule. However, before we do, we need to explore the validity of the model.</p>
<section id="model-summary-and-analysis-using-partial-regression-plots">
<h2>Model summary and analysis using partial regression plots<a class="headerlink" href="#model-summary-and-analysis-using-partial-regression-plots" title="Link to this heading">#</a></h2>
<p>A quick look at the results summary shows that the model has an excellent
R-squared value. Upon more careful examination, you may notice that one of our
descriptors has a very large p-value (<code class="docutils literal notranslate"><span class="pre">Z2</span></code>). This would indicate that perhaps the Z2
descriptor is not working well in this case. We can generate a more graphical
interpretation that will make this more obvious.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">graphics</span><span class="o">.</span><span class="n">plot_partregress_grid</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Part of the reason that Z2 may not be predictive in this model is that there is colinearity with the Z1 descriptor. Both descriptors have similar calculations (as outlined in the associating reading page for this activity). Later on in this exercise we can explore dropping this descriptor.</p>
</section>
<section id="how-good-is-our-model">
<h2>How good is our model?<a class="headerlink" href="#how-good-is-our-model" title="Link to this heading">#</a></h2>
<p>If we look at a plot of actual versus predicted boiling points</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pred_bp</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fittedvalues</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>       <span class="c1"># use our model to create a set of predicted bp&#39;s</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">lmod</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">pred_bp</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">BP_K</span><span class="p">)</span>           <span class="c1"># linear regression of observed vs predicted bp&#39;s</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">lmod</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>                          <span class="c1"># run fitting</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">pred_bp</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">BP_K</span><span class="p">)</span>             <span class="c1"># plot of of observed vs predicted bp&#39;s</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;observed boiling point (K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;predicted boiling point (K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>                      <span class="c1"># print linear regression stats summary</span>
</pre></div>
</div>
</div>
</div>
<p>The model appears to have very good predictability (<em>R<sup>2</sup></em> = 1.000) within the original 30 molecule data set. One way to test this model is to use a new molecule with its descriptors to see how well it is predicted. One molecule NOT in the dataset is <strong>2-methylheptane</strong>. It has the following data:</p>
<ul class="simple">
<li><p>MW = 114.232</p></li>
<li><p>Wiener Index = 79</p></li>
<li><p>Z1 = 28</p></li>
<li><p>Z2 = 26</p></li>
<li><p>Boiling Point = 390.6 K</p></li>
</ul>
<p>Using the equation from above we can determine that the boiling point from the equation</p>
<ul class="simple">
<li><p>Predicted BP = 4.4325 * MW - 0.6411 * Weiner Index - 4.3920 * Z1 + 0.2982 * Z2 + 55.5695</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#calculate boiling point of 2-methylheptane</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mordred</span><span class="w"> </span><span class="kn">import</span> <span class="n">Weight</span>   <span class="c1"># get molecular weight descriptor from mordred</span>
<span class="n">weight</span> <span class="o">=</span> <span class="n">Weight</span><span class="o">.</span><span class="n">Weight</span><span class="p">()</span>    <span class="c1"># create molecular weight calculator</span>

<span class="n">methylheptane</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s1">&#39;CCCCCC(C)C&#39;</span><span class="p">)</span>  <span class="c1"># generate an object for 2-methylheptane</span>

<span class="n">MW</span> <span class="o">=</span> <span class="n">weight</span><span class="p">(</span><span class="n">methylheptane</span><span class="p">)</span>                  <span class="c1"># calculate molecular weight of 2-methylheptane</span>
<span class="n">WienerIndex</span> <span class="o">=</span> <span class="n">wiener_index</span><span class="p">(</span><span class="n">methylheptane</span><span class="p">)</span>   <span class="c1"># calculate Wiener Index of 2-methylheptane</span>
<span class="n">Z1</span> <span class="o">=</span> <span class="n">zagreb_index1</span><span class="p">(</span><span class="n">methylheptane</span><span class="p">)</span>           <span class="c1"># calculate Z1 descriptor of 2-methylheptane</span>
<span class="n">Z2</span> <span class="o">=</span> <span class="n">zagreb_index2</span><span class="p">(</span><span class="n">methylheptane</span><span class="p">)</span>           <span class="c1"># calculate Z2 descriptor of 2-methylheptane</span>

<span class="n">PredictBP</span><span class="o">=</span> <span class="mf">4.4325</span> <span class="o">*</span> <span class="n">MW</span> <span class="o">-</span> <span class="mf">0.6411</span> <span class="o">*</span> <span class="n">WienerIndex</span> <span class="o">-</span> <span class="mf">4.3920</span> <span class="o">*</span> <span class="n">Z1</span> <span class="o">+</span> <span class="mf">0.2982</span> <span class="o">*</span> <span class="n">Z2</span> <span class="o">+</span> <span class="mf">55.5695</span>    <span class="c1"># predict boiling point</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Calculated boiling point of 2-methylheptane is&#39;</span><span class="p">,</span><span class="n">PredictBP</span><span class="p">,</span><span class="s1">&#39;K.&#39;</span><span class="p">)</span>

                          
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
<Strong>Check your understanding </Strong>
<ul class="simple">
<li><p>How does this prediction compare to the accepted literature value of 390.6 K?</p></li>
</ul>
<p>We had mentioned earlier that Z2 may not be very predictive in this model. We can remove the variable an rerun the analysis to see if we can improve the predictability of the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">statsmodels.api</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sm</span>           <span class="c1"># import the statsmodels library as sm</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;MW&quot;</span><span class="p">,</span> <span class="s2">&quot;Wiener&quot;</span><span class="p">,</span> <span class="s2">&quot;Z1&quot;</span><span class="p">]]</span>         <span class="c1"># select our independent variables, this time without Z2</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">add_constant</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>                 <span class="c1"># add an intercept to our model</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;BP_K&quot;</span><span class="p">]]</span>                       <span class="c1"># select BP as our dependent variable</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>              <span class="c1"># set up our model</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>         <span class="c1"># make the predictions</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>                 <span class="c1"># print out statistical summary</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-warning">
<Strong>Check your understanding </Strong>
<ul class="simple">
<li><p>After removal of Z2, what happened to the R<sup>2</sup> and p-values?</p></li>
<li><p>In the code cell below, write code to predice the boiling point of 2-methylheptane.</p></li>
<li><p>Does dropping Z2 change the result of the calculation?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#calculate boiling point of 2-methylheptane with new coefficients</span>
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-danger">
<p>Keep in mind that we have completed this analysis with only a training set of 30 molecules. If the training set had more molecules, you should be able to develop a better model.</p>
 <div class="alert alert-block alert-success">
      <H1><center>Homework</center></H1></section>
</section>
<section id="assignment-1">
<h1>Assignment 1<a class="headerlink" href="#assignment-1" title="Link to this heading">#</a></h1>
<p>You originally ran this analysis on a 30 molecule data set (BP.CSV). You also have available to you a 102 molecule data set (102BP.CSV).</p>
<p>Create a new python notebook titled <strong><code class="docutils literal notranslate"><span class="pre">QSPR_Assignment_1</span></code></strong>.</p>
<p>In the new notebook complete the above analysis using the expanded data set to determine if a better predictive model can be obtained with a larger training set. Note that 2-methylheptane is in this new dataset so you will need to choose a new test molecule. Use your chemical intuition.</p>
<div class="alert alert-block alert-success">
In a final markdown cell of the notebook, explain why you chose the test molecule and how close did the equation predict its boiling point. Explain why the equation did or did not predict well.</section>
<section id="assignment-2">
<h1>Assignment 2<a class="headerlink" href="#assignment-2" title="Link to this heading">#</a></h1>
<p>Create a new python notebook titled <strong><code class="docutils literal notranslate"><span class="pre">QSPR_Assignment_2</span></code></strong>. Create code to predict the 102 molecule data set (102BP.CSV).</p>
<p>In addition to molecular weight, choose 2 to 3 other calculated descriptors found in Mordred http://mordred-descriptor.github.io/documentation/master/api/modules.html</p>
<div class="alert alert-block alert-info">
some descriptors to consider include:
<ul class="simple">
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.BalabanJ.html?highlight=balaban#mordred.BalabanJ.BalabanJ" >BalabanJ (another topological index)</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">BalabanJ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">balabanj</span> <span class="pre">=</span> <span class="pre">BalabanJ.BalabanJ()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">Balaban</span> <span class="pre">J</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.ABCIndex.html" >ABCIndex(another topological index)</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">ABCIndex</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">abcindex</span> <span class="pre">=</span> <span class="pre">ABCIndex.ABCIndex()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">ABC</span> <span class="pre">Index</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.ABCIndex.html#:~:text=Graovac%2DGhorbani%20atom%2Dbond%20connectivity%20index%20descriptor." >Graovac-Ghorbani atom-bond connectivity index descriptor.</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">ABCGGIndex</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">abcindex</span> <span class="pre">=</span> <span class="pre">ABCIndex.ABCGGIndex()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">Graovac-Ghorbani</span> <span class="pre">atom-bond</span> <span class="pre">connectivity</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.VdwVolumeABC.html" >van der Waals volume</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">VdwVolumeABC</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">abcindex</span> <span class="pre">=</span> <span class="pre">VdwVolumeABC.VdwVolumeABC()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">van</span> <span class="pre">der</span> <span class="pre">Waals</span> <span class="pre">volume</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
</ul>
</div>
<p>Complete a new analysis with your chosen descriptors:</p>
<ul class="simple">
<li><p>Create a dataframe with molecular weight and all your new descriptors</p></li>
<li><p>Complete simple linear analysis for each of your new descriptors.</p></li>
<li><p>Complete a multiple linear regression to create an equation that best represents the data boiling point data and your descriptors.</p></li>
<li><p>Make a plot of Actual vs Predicted BP for your regression.</p></li>
<li><p>Choose a new molecule not in the dataset (not 2-methylheptane as it is in the dataset, be creative and use chemical intuition).</p></li>
<li><p>Use your multiple linear equation to predict this molecule’s BP and look of the literature value.</p></li>
<li><p>In addition to your jupyter notebook, <strong>write a short one to two page paper that includes:</strong></p>
<ul>
<li><p>What your new chosen descriptors describe</p></li>
<li><p>Which new chosen descriptors correlate to boiling point</p></li>
<li><p>How you use the output from statsmodels to generate the equation to calculate boiling point</p></li>
<li><p>How to choose the molecule to test</p></li>
<li><p>How close this multiple linear regression predicts your boiling point of your molecule</p></li>
</ul>
</li>
</ul>
</section>
<section id="extra-credit-challenge-assignment">
<h1>Extra Credit Challenge Assignment<a class="headerlink" href="#extra-credit-challenge-assignment" title="Link to this heading">#</a></h1>
<p>In 2016 researchers at the US Environmental Protection Agency and the National Toxicology Program at the National Institute of Environmental Health Sciences completed machine learning study to predict boiling points on a diverse set of molecules (https://pubs.acs.org/doi/10.1021/acs.jcim.6b00625). This dataset contained 5432 molecules with multiple types of functional groups. Their study focused on molecular fingerprints which you will study later on in this course.</p>
<p>You have been supplied with this dataset as a csv file (BP_JCIM2016.csv) with SMILES and boiling points in celsius and Kelvin.</p>
<p>Create a new python notbook titled <strong><code class="docutils literal notranslate"><span class="pre">QSPR_Extra_Credit</span></code></strong>.</p>
<p>In addition to molecular weight and the 2D indices you used here, choose 2 to 3 other calculated descriptors found in Mordred http://mordred-descriptor.github.io/documentation/master/api/modules.html</p>
<div class="alert alert-block alert-info">
some descriptors to consider include: (note sample python code shown as `python code`):
<ul class="simple">
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.BalabanJ.html?highlight=balaban#mordred.BalabanJ.BalabanJ" >BalabanJ (another topological index)</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">BalabanJ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">balabanj</span> <span class="pre">=</span> <span class="pre">BalabanJ.BalabanJ()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">Balaban</span> <span class="pre">J</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.TopoPSA.html" >Toplogical polar surface area (quick way to establish polarity)</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">TopoPSA</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TPSA</span> <span class="pre">=</span> <span class="pre">TopoPSA.TopoPSA()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">Topological</span> <span class="pre">polar</span> <span class="pre">surface</span> <span class="pre">area</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.HydrogenBond.html?highlight=hydrogen%20bond%20donor#mordred.HydrogenBond.HBondDonor:~:text=class%20mordred.HydrogenBond.HBondDonor,%C2%B6" >Hydrogen Bond Donor Count</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">HydrogenBond</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HBD</span> <span class="pre">=</span> <span class="pre">HydrogenBond.HBondDonor()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">hydrogen</span> <span class="pre">bond</span> <span class="pre">donor</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.HydrogenBond.html?highlight=hydrogen%20bond%20donor#mordred.HydrogenBond.HBondAcceptor:~:text=class%20mordred.,%C2%B6" >Hydrogen Bond Acceptor count</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">HydrogenBond</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HBA</span> <span class="pre">=</span> <span class="pre">HydrogenBond.HBondAcceptor()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">hydrogen</span> <span class="pre">bond</span> <span class="pre">acceptor</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
</ul>
</div>
<p>Complete a new analysis with your chosen descriptors:</p>
<ul class="simple">
<li><p>Complete simple linear analysis for each of your new descriptors.</p></li>
<li><p>Complete a multiple linear regression to create an equation that best represents the data boiling point data and your descriptors.</p></li>
<li><p>Make a plot of Actual vs Predicted BP for your regression.</p></li>
<li><p>Choose a new molecule not in the dataset (not 2-methylheptane as it is in the dataset, be creative and use chemical intuition).</p></li>
<li><p>Use your multiple linear equation to predict this molecule’s BP and look of the literature value.</p></li>
<li><p>Write a short one-two page paper that includes:</p>
<ul>
<li><p>What your new chosen descriptors mean</p></li>
<li><p>Which new chosen descriptors correlate</p></li>
<li><p>What is the overall equation calculated</p></li>
<li><p>How to choose the molecule to test</p></li>
<li><p>How close this multiple linear regression predicts your boiling point of your molecule</p></li>
</ul>
</li>
</ul>
</section>
<section id="id1">
<h1>Extra Credit Challenge Assignment<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<p>In 2016 researchers at the US Environmental Protection Agency and the National Toxicology Program at the National Institute of Environmental Health Sciences completed machine learning study to predict boiling points on a diverse set of molecules (https://pubs.acs.org/doi/10.1021/acs.jcim.6b00625). This dataset contained 4074 molecules with multiple types of functional groups. Their study focused on molecular fingerprints which you will study later on in this course.</p>
<p>You have been supplied with this dataset as a csv file (<strong>BP_JCIM2016_4074.csv</strong>) with SMILES and boiling points in celsius and Kelvin.</p>
<p>Create a new python notebook titled <strong><code class="docutils literal notranslate"><span class="pre">QSPR_Extra_Credit</span></code></strong>.</p>
<p>In addition to molecular weight, choose one of the 2D indices you used above(Z1, Z2, Wiener), choose 4 to 5 other calculated descriptors found in Mordred http://mordred-descriptor.github.io/documentation/master/api/modules.html</p>
<div class="alert alert-block alert-info">
some descriptors to consider include:
<ul class="simple">
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.BalabanJ.html?highlight=balaban#mordred.BalabanJ.BalabanJ" >BalabanJ (another topological index)</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">BalabanJ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">balabanj</span> <span class="pre">=</span> <span class="pre">BalabanJ.BalabanJ()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">Balaban</span> <span class="pre">J</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.TopoPSA.html" >Toplogical polar surface area (quick way to establish polarity)</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">TopoPSA</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TPSA</span> <span class="pre">=</span> <span class="pre">TopoPSA.TopoPSA()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">Topological</span> <span class="pre">polar</span> <span class="pre">surface</span> <span class="pre">area</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.HydrogenBond.html?highlight=hydrogen%20bond%20donor#mordred.HydrogenBond.HBondDonor:~:text=class%20mordred.HydrogenBond.HBondDonor,%C2%B6" >Hydrogen Bond Donor Count</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">HydrogenBond</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HBD</span> <span class="pre">=</span> <span class="pre">HydrogenBond.HBondDonor()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">hydrogen</span> <span class="pre">bond</span> <span class="pre">donor</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
<li><p><a href="https://mordred-descriptor.github.io/documentation/master/api/mordred.HydrogenBond.html?highlight=hydrogen%20bond%20donor#mordred.HydrogenBond.HBondAcceptor:~:text=class%20mordred.,%C2%B6" >Hydrogen Bond Acceptor count</a></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">mordred</span> <span class="pre">import</span> <span class="pre">HydrogenBond</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HBA</span> <span class="pre">=</span> <span class="pre">HydrogenBond.HBondAcceptor()</span>&#160;&#160;&#160; <span class="pre">#</span> <span class="pre">create</span> <span class="pre">hydrogen</span> <span class="pre">bond</span> <span class="pre">acceptor</span> <span class="pre">calculator</span></code></p></li>
</ul>
</li>
</ul>
</div>
<p>Complete a new analysis with your chosen descriptors:</p>
<ul class="simple">
<li><p>Create a dataframe with molecular weight and all your new descriptors</p></li>
<li><p>Complete simple linear analysis for each of your new descriptors.</p></li>
<li><p>Complete a multiple linear regression to create an equation that best represents the data boiling point data and your descriptors.</p></li>
<li><p>Make a plot of Actual vs Predicted BP for your regression.</p></li>
<li><p>Choose a new molecule not in the dataset (not 2-methylheptane as it is in the dataset, be creative and use chemical intuition).</p></li>
<li><p>Use your multiple linear equation to predict this molecule’s BP and look of the literature value.</p></li>
</ul>
<div class="alert alert-block alert-success">
In a final markdown cell of the notebook, explain why this dataset is so challenging to create a multiple linear regression analysis that can predict the boiling points of this diverse dataset.
</section>
<section class="tex2jax_ignore mathjax_ignore" id="acknowledgment">
<h1>Acknowledgment<a class="headerlink" href="#acknowledgment" title="Link to this heading">#</a></h1>
<p>This module was developed by Ehren Bulchotz and has a CC BY-NC-SA 4.0 license</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "datachem"
        },
        kernelOptions: {
            name: "datachem",
            path: "./content/modules/07-QSAR-QSPR"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'datachem'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="README.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Module 7: Quantitative Structure Property Reationships</p>
      </div>
    </a>
    <a class="right-next"
       href="../08-Molecular-Similarity/README.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Module 8: Molecular Similarity</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Molecular Descriptors</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#using-rdkit-and-mordred-to-calculate-descriptors">Using rdkit and Mordred to calculate descriptors</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wiener-index">Wiener Index</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#zagreb-indices">Zagreb Indices</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#looping-through-a-list-of-molecules">Looping through a list of molecules</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#using-descriptors-to-predict-molecular-properties">Using descriptors to predict molecular properties</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boiling-point-data">Boiling Point data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphing-the-data">Graphing the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-descriptors-to-the-dataset">Adding descriptors to the dataset</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mulitple-regression-analysis-using-statsmodels">Mulitple regression analysis using statsmodels</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-summary-and-analysis-using-partial-regression-plots">Model summary and analysis using partial regression plots</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-good-is-our-model">How good is our model?</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-1">Assignment 1</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#assignment-2">Assignment 2</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#extra-credit-challenge-assignment">Extra Credit Challenge Assignment</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Extra Credit Challenge Assignment</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#acknowledgment">Acknowledgment</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Robert Belford
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>